<!DOCTYPE html>
<html>
  <head>

    <meta charset="UTF-8">
    <title>GOA</title>
<!-- Firebase -->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCAKd5xQtlYZLGU8Oc1O4-MhtR1N6fGx3M&callback"></script>
<script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-firestore.js"></script>
       <script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-storage.js"></script>

  <script>
  
  

 // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyCJ4VOKZ5DWI4Gjnyr-hZLRXeqsZTrfykg",
    authDomain: "goapothole.firebaseapp.com",
    databaseURL: "https://goapothole.firebaseio.com",
    projectId: "goapothole",
    storageBucket: "goapothole.appspot.com",
    messagingSenderId: "444456422648",
    appId: "1:444456422648:web:c3032fa57da37016fcbf0d"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  </script>
    
    <script src="https://www.gstatic.com/firebasejs/ui/4.3.0/firebase-ui-auth.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.3.0/firebase-ui-auth.css" />
    <link rel="stylesheet" href="styles.css">
    
  </head>
  <body>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="/__/firebase/8.2.4/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="/__/firebase/8.2.4/firebase-analytics.js"></script>

<!-- Initialize Firebase -->
<script src="/__/firebase/init.js"></script>
 <br/>
    
    
    <!-- Profile Form -->
    <form class="container" id="profileform" method="post" action="sql.php">

    <center><h4>PROFILE</h4></center>
    <br/>
        <br/>

<div class="form-group">
<input  type="text" name="phonenumber" id="phonenumber" value="" />
              <label for="input" class="control-label">NUMBER</label><i class="bar"></i>
            </div>  
            
            
            <div class="form-group">
<input  type="number" name="savepincode" id="savepincode" value=""/>
              <label for="input" class="control-label">PINCODE</label><i class="bar"></i>
            </div>  
                  <br/>
            <!--      
              <div class="form-group">
<textarea  type="textarea" name="address" id="address" value=""></textarea>
              <label for="input" class="control-label">ADDRESS</label><i class="bar"></i>
            </div> 
                  <br/>
                  -->

<div id="profileerror"></div>

<center><button  class="button"  id="save"><span>SAVE</span></button></center>

</form>



<!-- Complain Form -->
 <form class="container" id="complainform" action="complain.php" method="post" >
 
    <center><h4>COMPLAIN DETAILS</h4></center>
    <br/>
        <br/>

    <div class="form-group">
<input  type="text" name="pincode" id="pincode" value=""/>
              <label for="input" class="control-label">TEAM NAME</label><i class="bar"></i>
            </div>  
                  <br/>
                  <div class="form-group" >
                    <input  type="text" name="phonenumber" id="complainphonenumber" value=""/>
                                  <label for="input" class="control-label">TEAM TAG</label><i class="bar"></i>
                                </div> 
                                <br/>
     
     <input id="complainimg" type="file" name="complainimg" style="width:100%;" accept=".png, .jpg, .jpeg">
        <progress value="0" max="100" id="uploader"></progress>
      <div>
            <div id="imagePreview">
            <img id="img" width="100%" src="" style="display:none;">
            </div>
        </div>
     
            <br/>

            <br>
            <div class="form-group">
<input  type="text" name="imgurl" id="imgurl" value="" readonly/>
              <label for="input" class="control-label">imgurl</label><i class="bar"></i>
            </div>   

     
                  <div id="locationmessage"></div>
                  
                  <br/>
     <center><button  class="button"  id="submitcomplain" style="display:none;"><span>SUBMIT</span></button></center>
<br/>
</form>

<form method="post" id="fixedform" action="fixed.php" class="container" style="display:none;">
                <div class="form-group" style="display:none;">
<input  type="text" name="userphonenumber" id="userphonenumber" value="" readonly/>
              <label for="input" class="control-label">userphone</label><i class="bar"></i>
            </div>   

                  <br/>
     <center><button  class="button" id="fixedbtn" style="display:none;"><span>FIXED POTHOLES</span></button></center>
<br/>
</form>
<script>
//for the image
  function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function(e) {
            $('#img').attr({ src: e.target.result});
            $('#imagePreview').hide();
            $('#imagePreview').fadeIn(650);
        }
        reader.readAsDataURL(input.files[0]);
    }
}
$("#complainimg").change(function() {
    readURL(this);
});


//to upload the image and get the download link for the image and display it in html
var artup = document.getElementById('complainimg');

var uploader = document.getElementById('uploader');
artup.addEventListener('change', function(e){
  var file = e.target.files[0];

  var upart = firebase.storage().ref('complainimg/' + file.name);
  // console.log(upart);
  var load = upart.put(file);
  load.on('state_changed',
  function progress(snapshot){
    var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
    uploader.value = percentage;
  },
  
  //runs if there is an error in uploading
    function error(err){
      alert("error");
    },

    //runs when complainimg is uploaded
    function complete(){
      upart.getDownloadURL().then(function(url) {
         document.getElementById('imgurl').value = url;
        $("#img").attr({
          src: url
        });
    },
  )
  document.getElementById('img').style.display="block";
   document.getElementById('submitcomplain').style.display="block";
    });
});

</script>
  </body>
</html>